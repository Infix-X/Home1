<script src="react.js"></script>
<script src="reactDOM.js"></script>
<script src="babel.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>

</style>

<div id="root"></div>

<script type="text/babel">
     const Pagination = ({ currPage, setCurrPage, totalPages }) => {
            const inputRef = React.useRef()
            const fnGo = () => {
                const pageNo = inputRef.current.value;
                if (pageNo < 1 || pageNo > totalPages) {
                    alert("Invalid Entry");
                    return;
                }
                setCurrPage(Number(pageNo))
            }
            const fnNext = () => {
                setCurrPage(currPage + 1)
            }

            const fnPrev = () => {
                setCurrPage(currPage - 1)
            }
            return <div className="text-center">
                <span>Go To :<input ref={inputRef} type="number" />
                    <button onClick={fnGo}>Go</button></span>
                    <button onClick={fnPrev} disabled={currPage == 1}>Prev</button>{currPage}<button onClick={fnNext} disabled={currPage == totalPages}>Next</button><span>Total Pages:{totalPages}</span>
            </div>
        }
        const Table = (props) => {
            const {  headings, data, keys } = props;
            return <div>
                <table border="2px" className="table table-bordered">
                    <thead>
                        <tr>
                            {
                                headings.map((v, i) => {
                                    return <th key={"th_" + i}>{v}</th>
                                })
                            }
                        </tr>
                    </thead>
                    <tbody>
                        {
                            data.map((obj, ind) => {
                                return <tr key={"tr_" + ind}>
                                    {
                                        keys.map((k, i) => {
                                            return <td key={"td_" + i}>{obj[k]} </td>
                                        })
                                    }
                                </tr>
                            })
                        }
                    </tbody>
                </table>
            </div>
        }
    // prepare content
    const App = () => {
        const [photos,setPhotos]=React.useState([])
        const [currData,setCurrData]=React.useState([])
        const [currPage,setCurrPage]=React.useState(1)
        const perPage=100;

        React.useEffect(()=>{
            const end=currPage*perPage
            const start=end-perPage;
            setCurrData(photos.slice(start,end))
        },[currPage])

        const fnGetPhotos=()=>{
            //url: https://jsonplaceholder.typicode.com/photos
            //method: get
            const obj=new XMLHttpRequest();
            // preapare the requiest
            obj.open("get","https://jsonplaceholder.typicode.com/photos")
            // send the request
            obj.send();
            // processing the request ? server side guy will takecare

            // get the resposne from server side guy 
            // success response 
            obj.onload=()=>{
              let res= obj.responseText;
              res=JSON.parse(res)
              setPhotos(res)
              setCurrData(res.slice(0, perPage))
            }
            // failues 
            obj.onerror=()=>{
                alert('fail');
                 setPhotos([])
            }
        }
        return <div>
              <button onClick={fnGetPhotos}>Get Photos</button>
              {currData.length > 0 && <div>
                  <Pagination
                    currPage={currPage}
                    setCurrPage={setCurrPage}  
                    totalPages={Math.ceil(photos.length / perPage)}
                />
                <Table 
                headings={["ID","TITLE","URL"]}
                data={currData}
                keys={['id','title','url']}
              />
            
              </div>
              }
            </div>

    }

    // container ref
    const container = document.getElementById("root")
    const root = ReactDOM.createRoot(container);
    // render content inide the container
    root.render(<App></App>)

</script>